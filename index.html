<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pastel Teddy Claw Machine</title>

<style>
body{
    margin:0;
    background:#f7d9df;
    font-family:Arial, sans-serif;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
}

/* MACHINE BODY */
.machine{
    width:420px;
    height:720px;
    background:#f4bfc9;
    border-radius:25px;
    box-shadow:0 20px 40px rgba(0,0,0,0.3);
    position:relative;
    padding:20px;
}

/* GLASS AREA */
.glass{
    width:100%;
    height:480px;
    background:rgba(255,255,255,0.35);
    border-radius:20px;
    position:relative;
    overflow:hidden;
    border:5px solid #e7aab6;
}

/* CLAW */
.claw{
    position:absolute;
    top:0;
    left:170px;
    width:80px;
    height:140px;
    transition:top 0.2s;
}

.cable{
    width:6px;
    height:70px;
    background:#777;
    margin:auto;
}

.claw-head{
    width:80px;
    height:25px;
    background:linear-gradient(#eee,#aaa);
    border-radius:15px;
    position:relative;
}

.arm{
    position:absolute;
    width:6px;
    height:50px;
    background:#ccc;
    bottom:-45px;
    transform-origin:top center;
    transition:0.3s;
}

.left-arm{ left:18px; transform:rotate(30deg); }
.right-arm{ right:18px; transform:rotate(-30deg); }

.grab .left-arm{ transform:rotate(5deg); }
.grab .right-arm{ transform:rotate(-5deg); }

/* TEDDIES */
.teddy{
    width:70px;
    height:70px;
    background:#f5e6d3;
    border-radius:50%;
    position:absolute;
    display:flex;
    justify-content:center;
    align-items:center;
    font-size:30px;
    user-select:none;
}

/* CONTROL PANEL */
.panel{
    margin-top:20px;
    height:120px;
    background:#eaa9b6;
    border-radius:20px;
    display:flex;
    justify-content:space-around;
    align-items:center;
}

.joystick{
    width:80px;
    height:80px;
    background:#333;
    border-radius:50%;
    position:relative;
    touch-action:none;
}

.stick{
    width:40px;
    height:40px;
    background:#000;
    border-radius:50%;
    position:absolute;
    top:20px;
    left:20px;
}

.drop-btn{
    width:70px;
    height:70px;
    background:red;
    border-radius:50%;
    border:none;
    box-shadow:0 5px 0 darkred;
}

.score{
    position:absolute;
    bottom:15px;
    right:20px;
    font-size:18px;
}
</style>
</head>
<body>

<div class="machine">
    <div class="glass" id="glass">
        <div class="claw" id="claw">
            <div class="cable"></div>
            <div class="claw-head">
                <div class="arm left-arm"></div>
                <div class="arm right-arm"></div>
            </div>
        </div>
    </div>

    <div class="panel">
        <div class="joystick" id="joystick">
            <div class="stick" id="stick"></div>
        </div>
        <button class="drop-btn" onclick="dropClaw()"></button>
    </div>

    <div class="score">Score: <span id="score">0</span></div>
</div>

<script>
const claw=document.getElementById("claw");
const glass=document.getElementById("glass");
const joystick=document.getElementById("joystick");
const stick=document.getElementById("stick");

let clawX=170;
let dropping=false;
let score=0;

const audioCtx=new(window.AudioContext||window.webkitAudioContext)();

/* CREATE TEDDIES */
function createTeddies(){
    for(let i=0;i<10;i++){
        let teddy=document.createElement("div");
        teddy.className="teddy";
        teddy.innerHTML="ðŸ§¸";
        teddy.style.left=Math.random()*320+"px";
        teddy.style.bottom=Math.random()*200+"px";
        glass.appendChild(teddy);
    }
}
createTeddies();

/* JOYSTICK CONTROL */
joystick.addEventListener("pointermove",e=>{
    if(e.buttons!==1)return;
    const rect=joystick.getBoundingClientRect();
    let x=e.clientX-rect.left-40;
    x=Math.max(-25,Math.min(25,x));
    stick.style.left=(20+x)+"px";

    clawX+=x*0.1;
    clawX=Math.max(0,Math.min(340,clawX));
    claw.style.left=clawX+"px";
});

/* DROP FUNCTION */
function dropClaw(){
    if(dropping)return;
    dropping=true;
    claw.classList.add("grab");
    playSound();

    let y=0;
    let interval=setInterval(()=>{
        y+=10;
        claw.style.top=y+"px";
        if(y>=320){
            clearInterval(interval);
            checkCatch();
        }
    },30);
}

/* SMART CATCH */
function checkCatch(){
    const teddies=document.querySelectorAll(".teddy");
    teddies.forEach(t=>{
        const tr=t.getBoundingClientRect();
        const cr=claw.getBoundingClientRect();
        if(cr.left<tr.right && cr.right>tr.left){
            let diff=Math.abs((cr.left+40)-(tr.left+35));
            let accuracy=Math.max(0,1-diff/80);
            if(Math.random()<accuracy){
                t.remove();
                score++;
                document.getElementById("score").innerText=score;
            }
        }
    });

    setTimeout(()=>{
        claw.style.top="0";
        claw.classList.remove("grab");
        dropping=false;
    },500);
}

/* SOUND */
function playSound(){
    const osc=audioCtx.createOscillator();
    const gain=audioCtx.createGain();
    osc.connect(gain);
    gain.connect(audioCtx.destination);
    osc.frequency.value=700;
    gain.gain.setValueAtTime(0.2,audioCtx.currentTime);
    osc.start();
    osc.stop(audioCtx.currentTime+0.15);
}
</script>

</body>
</html>
